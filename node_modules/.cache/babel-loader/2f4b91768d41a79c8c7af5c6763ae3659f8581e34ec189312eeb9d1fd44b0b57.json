{"ast":null,"code":"var _jsxFileName = \"/Users/fan/Documents/GitHub/nunu/src/component/MapScene.jsx\",\n  _s = $RefreshSig$();\nimport React, { useRef, useState, useEffect } from \"react\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { X } from \"lucide-react\";\nimport van1 from \"../assets/images/van1.webp\";\nimport van2 from \"../assets/images/van2.webp\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst points = [{\n  id: 1,\n  lengthPerc: 0.3,\n  modal: {\n    /* … */\n  }\n}, {\n  id: 2,\n  lengthPerc: 1.0,\n  modal: {\n    /* … */\n  }\n}];\nexport default function MapScene() {\n  _s();\n  const pathRef = useRef(null);\n  const [progress, setProgress] = useState(0);\n  const [targetPerc, setTargetPerc] = useState(0);\n  const [animating, setAnimating] = useState(false);\n  const [currentPoint, setCurrentPoint] = useState(null);\n  const [showModal, setShowModal] = useState(false);\n  const [carImage, setCarImage] = useState(van1);\n  const [pos, setPos] = useState({\n    x: 0,\n    y: 0\n  });\n\n  // 點擊點位時設定目標百分比並開始動畫\n  const handleClick = point => {\n    setShowModal(false);\n    setCarImage(point.id === 2 ? van2 : van1);\n    setCurrentPoint(point);\n    setTargetPerc(point.lengthPerc);\n    setProgress(0);\n    setAnimating(true);\n  };\n\n  // 根據 progress 計算車子座標\n  useEffect(() => {\n    if (!pathRef.current) return;\n    const path = pathRef.current;\n    const total = path.getTotalLength();\n    const point = path.getPointAtLength(total * progress);\n    setPos({\n      x: point.x,\n      y: point.y\n    });\n  }, [progress]);\n\n  // 動畫循環\n  useEffect(() => {\n    if (!animating) return;\n    let raf;\n    const step = () => {\n      setProgress(prev => {\n        const next = prev + 0.005;\n        if (next >= targetPerc) {\n          window.cancelAnimationFrame(raf);\n          setAnimating(false);\n          setTimeout(() => setShowModal(true), 1000);\n          return targetPerc;\n        }\n        raf = window.requestAnimationFrame(step);\n        return next;\n      });\n    };\n    raf = window.requestAnimationFrame(step);\n    return () => window.cancelAnimationFrame(raf);\n  }, [animating, targetPerc]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"relative w-full h-[400px] bg-[#f1efea] overflow-hidden rounded-xl border\",\n    children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n      className: \"absolute w-full h-full\",\n      viewBox: \"0 0 970 435\",\n      children: /*#__PURE__*/_jsxDEV(\"path\", {\n        ref: pathRef,\n        d: \"M323.957 434.466H... (\\u4F60\\u7684 path)\",\n        fill: \"none\",\n        stroke: \"#aaa\",\n        strokeDasharray: \"6 6\",\n        strokeWidth: \"2\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(motion.img, {\n      src: carImage,\n      alt: \"van\",\n      className: \"absolute w-32 h-32\",\n      animate: {\n        x: pos.x,\n        y: pos.y\n      },\n      transition: {\n        duration: 0\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 7\n    }, this), points.map(p => /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: () => handleClick(p),\n      className: \"absolute w-8 h-8 rounded-full bg-white border text-sm font-bold\",\n      style: {\n        left: pathRef.current ? pathRef.current.getPointAtLength(pathRef.current.getTotalLength() * p.lengthPerc).x : 0,\n        top: pathRef.current ? pathRef.current.getPointAtLength(pathRef.current.getTotalLength() * p.lengthPerc).y : 0\n      },\n      children: p.id\n    }, p.id, false, {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 9\n    }, this)), /*#__PURE__*/_jsxDEV(AnimatePresence, {\n      children: showModal && currentPoint && /*#__PURE__*/_jsxDEV(motion.div, {\n        initial: {\n          scaleX: 0\n        },\n        animate: {\n          scaleX: 1\n        },\n        exit: {\n          scaleX: 0\n        },\n        transition: {\n          duration: 0.4\n        },\n        className: \"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 origin-center bg-white border-2 border-red-400 p-4 rounded-xl shadow-xl flex gap-4 items-center\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setShowModal(false),\n          className: \"absolute top-2 right-2 text-red-500\",\n          children: /*#__PURE__*/_jsxDEV(X, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 131,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 127,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 75,\n    columnNumber: 5\n  }, this);\n}\n_s(MapScene, \"bYaBG16zgBu4HyLSEqETZ6zyD8Y=\");\n_c = MapScene;\nvar _c;\n$RefreshReg$(_c, \"MapScene\");","map":{"version":3,"names":["React","useRef","useState","useEffect","motion","AnimatePresence","X","van1","van2","jsxDEV","_jsxDEV","points","id","lengthPerc","modal","MapScene","_s","pathRef","progress","setProgress","targetPerc","setTargetPerc","animating","setAnimating","currentPoint","setCurrentPoint","showModal","setShowModal","carImage","setCarImage","pos","setPos","x","y","handleClick","point","current","path","total","getTotalLength","getPointAtLength","raf","step","prev","next","window","cancelAnimationFrame","setTimeout","requestAnimationFrame","className","children","viewBox","ref","d","fill","stroke","strokeDasharray","strokeWidth","fileName","_jsxFileName","lineNumber","columnNumber","img","src","alt","animate","transition","duration","map","p","onClick","style","left","top","div","initial","scaleX","exit","_c","$RefreshReg$"],"sources":["/Users/fan/Documents/GitHub/nunu/src/component/MapScene.jsx"],"sourcesContent":["import React, { useRef, useState, useEffect } from \"react\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { X } from \"lucide-react\";\nimport van1 from \"../assets/images/van1.webp\";\nimport van2 from \"../assets/images/van2.webp\";\n\nconst points = [\n  {\n    id: 1,\n    lengthPerc: 0.3,\n    modal: {\n      /* … */\n    },\n  },\n  {\n    id: 2,\n    lengthPerc: 1.0,\n    modal: {\n      /* … */\n    },\n  },\n];\n\nexport default function MapScene() {\n  const pathRef = useRef(null);\n  const [progress, setProgress] = useState(0);\n  const [targetPerc, setTargetPerc] = useState(0);\n  const [animating, setAnimating] = useState(false);\n  const [currentPoint, setCurrentPoint] = useState(null);\n  const [showModal, setShowModal] = useState(false);\n  const [carImage, setCarImage] = useState(van1);\n  const [pos, setPos] = useState({ x: 0, y: 0 });\n\n  // 點擊點位時設定目標百分比並開始動畫\n  const handleClick = (point) => {\n    setShowModal(false);\n    setCarImage(point.id === 2 ? van2 : van1);\n    setCurrentPoint(point);\n    setTargetPerc(point.lengthPerc);\n    setProgress(0);\n    setAnimating(true);\n  };\n\n  // 根據 progress 計算車子座標\n  useEffect(() => {\n    if (!pathRef.current) return;\n    const path = pathRef.current;\n    const total = path.getTotalLength();\n    const point = path.getPointAtLength(total * progress);\n    setPos({ x: point.x, y: point.y });\n  }, [progress]);\n\n  // 動畫循環\n  useEffect(() => {\n    if (!animating) return;\n    let raf;\n    const step = () => {\n      setProgress((prev) => {\n        const next = prev + 0.005;\n        if (next >= targetPerc) {\n          window.cancelAnimationFrame(raf);\n          setAnimating(false);\n          setTimeout(() => setShowModal(true), 1000);\n          return targetPerc;\n        }\n        raf = window.requestAnimationFrame(step);\n        return next;\n      });\n    };\n    raf = window.requestAnimationFrame(step);\n    return () => window.cancelAnimationFrame(raf);\n  }, [animating, targetPerc]);\n\n  return (\n    <div className=\"relative w-full h-[400px] bg-[#f1efea] overflow-hidden rounded-xl border\">\n      <svg className=\"absolute w-full h-full\" viewBox=\"0 0 970 435\">\n        <path\n          ref={pathRef}\n          d=\"M323.957 434.466H... (你的 path)\"\n          fill=\"none\"\n          stroke=\"#aaa\"\n          strokeDasharray=\"6 6\"\n          strokeWidth=\"2\"\n        />\n      </svg>\n\n      <motion.img\n        src={carImage}\n        alt=\"van\"\n        className=\"absolute w-32 h-32\"\n        animate={{ x: pos.x, y: pos.y }}\n        transition={{ duration: 0 }}\n      />\n\n      {points.map((p) => (\n        <button\n          key={p.id}\n          onClick={() => handleClick(p)}\n          className=\"absolute w-8 h-8 rounded-full bg-white border text-sm font-bold\"\n          style={{\n            left: pathRef.current\n              ? pathRef.current.getPointAtLength(\n                  pathRef.current.getTotalLength() * p.lengthPerc\n                ).x\n              : 0,\n            top: pathRef.current\n              ? pathRef.current.getPointAtLength(\n                  pathRef.current.getTotalLength() * p.lengthPerc\n                ).y\n              : 0,\n          }}\n        >\n          {p.id}\n        </button>\n      ))}\n\n      <AnimatePresence>\n        {showModal && currentPoint && (\n          <motion.div\n            initial={{ scaleX: 0 }}\n            animate={{ scaleX: 1 }}\n            exit={{ scaleX: 0 }}\n            transition={{ duration: 0.4 }}\n            className=\"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 origin-center bg-white border-2 border-red-400 p-4 rounded-xl shadow-xl flex gap-4 items-center\"\n          >\n            {/* Modal 內容 */}\n            <button\n              onClick={() => setShowModal(false)}\n              className=\"absolute top-2 right-2 text-red-500\"\n            >\n              <X />\n            </button>\n          </motion.div>\n        )}\n      </AnimatePresence>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}