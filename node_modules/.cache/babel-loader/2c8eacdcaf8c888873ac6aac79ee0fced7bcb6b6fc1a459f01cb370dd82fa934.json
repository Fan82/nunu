{"ast":null,"code":"var _jsxFileName = \"/Users/fan/Documents/GitHub/nunu/src/component/MapScene.jsx\",\n  _s = $RefreshSig$();\nimport { useRef, useState, useEffect } from \"react\";\nimport { motion } from \"framer-motion\";\nimport carImg from \"../assets/images/van1.webp\";\nimport markerImg1 from \"../assets/images/cake/mainImage.webp\"; // 假設這是你的第一個標記圖片\nimport markerImg2 from \"../assets/images/cake/mainImage.webp\"; // 假設這是你的第二個標記圖片\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function MapScene({\n  onTrigger\n}) {\n  _s();\n  const pathA = useRef(null);\n  const pathB = useRef(null);\n  const [carPos, setCarPos] = useState({\n    x: 0,\n    y: 0\n  });\n  const [showCar, setShowCar] = useState(true);\n  const [activePath, setActivePath] = useState(null); // 這行其實可以移除，因為沒有被使用到\n\n  // 將車子定位在 pathA 起點，並放大尺寸\n  useEffect(() => {\n    // 確保 pathA.current 已經存在才進行操作\n    if (pathA.current) {\n      const p = pathA.current.getPointAtLength(0);\n      setCarPos({\n        x: p.x,\n        y: p.y\n      });\n    }\n  }, []);\n\n  // 控制車子行駛動畫\n  const runPath = (pathRef, onComplete) => {\n    const total = pathRef.current.getTotalLength();\n    let start = null;\n    const duration = 1500; // 動畫持續時間 (毫秒)\n\n    const animate = timestamp => {\n      if (!start) start = timestamp;\n      const elapsed = timestamp - start;\n      const progress = Math.min(elapsed / duration, 1);\n      const point = pathRef.current.getPointAtLength(total * progress);\n\n      // 更新車子位置，考慮置中\n      setCarPos({\n        x: point.x - 32,\n        y: point.y - 32\n      }); // 減去車子寬高的一半 (w-16 h-16 => 8 * 2 = 32)\n\n      if (progress < 1) {\n        requestAnimationFrame(animate);\n      } else {\n        // 動畫結束後，延遲 1 秒呼叫 onComplete\n        setTimeout(() => {\n          onComplete();\n        }, 1000);\n      }\n    };\n    requestAnimationFrame(animate);\n  };\n\n  // 點擊按鈕時觸發行駛\n  const handleClick = target => {\n    setShowCar(true);\n    const pathRef = target === 1 ? pathA : pathB;\n\n    // 在這裡呼叫 runPath，並將 onTrigger 傳入其回呼函式\n    runPath(pathRef, () => {\n      // 確保 onTrigger 是一個函式才呼叫\n      if (typeof onTrigger === \"function\") {\n        onTrigger(target); // 這裡只會呼叫一次 onTrigger，且在動畫完成後\n      }\n    });\n  };\n\n  // 用圖片替換數字按鈕的標記點\n  const marker = (ref, targetId, imgSrc) => {\n    var _ref$current, _ref$current2;\n    // 等待 ref.current 存在\n    const total = ((_ref$current = ref.current) === null || _ref$current === void 0 ? void 0 : _ref$current.getTotalLength()) || 0;\n    const p = (_ref$current2 = ref.current) === null || _ref$current2 === void 0 ? void 0 : _ref$current2.getPointAtLength(total);\n    if (!p) return null; // 如果點位不存在，則不渲染\n\n    return /*#__PURE__*/_jsxDEV(\"img\", {\n      src: imgSrc,\n      alt: `marker-${targetId}`,\n      className: \"absolute w-8 h-8 cursor-pointer\" // 圖片尺寸，可以根據需要調整\n      ,\n      style: {\n        left: p.x - 12,\n        top: p.y - 12\n      } // 調整位置使圖片中心對準路徑終點\n      ,\n      onClick: () => handleClick(targetId)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 7\n    }, this);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"relative w-full h-[300px] bg-white overflow-hidden\",\n    children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n      className: \"absolute w-full h-full\",\n      viewBox: \"0 0 700 300\",\n      children: [/*#__PURE__*/_jsxDEV(\"path\", {\n        ref: pathA,\n        d: \"M0 89H227.5V4H337\",\n        fill: \"none\",\n        stroke: \"#3B3B3B\",\n        strokeOpacity: \"0.63\",\n        strokeWidth: \"8\",\n        strokeLinejoin: \"round\",\n        strokeDasharray: \"5 5\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n        ref: pathB,\n        d: \"M300 10V209H413V26H491.5\",\n        fill: \"none\",\n        stroke: \"#3B3B3B\",\n        strokeOpacity: \"0.63\",\n        strokeWidth: \"8\",\n        strokeLinejoin: \"round\",\n        strokeDasharray: \"5 5\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 7\n    }, this), showCar && /*#__PURE__*/_jsxDEV(motion.img, {\n      src: carImg,\n      alt: \"car\",\n      className: \"absolute w-16 h-16\" // 放大車子（原本可能是 w-8 h-8）\n      ,\n      style: {\n        left: carPos.x,\n        top: carPos.y\n      } // CarPos 現在已經包含了置中計算\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 9\n    }, this), marker(pathA, 1, markerImg1), marker(pathB, 2, markerImg2)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 85,\n    columnNumber: 5\n  }, this);\n}\n_s(MapScene, \"Aa9t2n6/PpP8s1XEpm2Tpt9GzbY=\");\n_c = MapScene;\nvar _c;\n$RefreshReg$(_c, \"MapScene\");","map":{"version":3,"names":["useRef","useState","useEffect","motion","carImg","markerImg1","markerImg2","jsxDEV","_jsxDEV","MapScene","onTrigger","_s","pathA","pathB","carPos","setCarPos","x","y","showCar","setShowCar","activePath","setActivePath","current","p","getPointAtLength","runPath","pathRef","onComplete","total","getTotalLength","start","duration","animate","timestamp","elapsed","progress","Math","min","point","requestAnimationFrame","setTimeout","handleClick","target","marker","ref","targetId","imgSrc","_ref$current","_ref$current2","src","alt","className","style","left","top","onClick","fileName","_jsxFileName","lineNumber","columnNumber","children","viewBox","d","fill","stroke","strokeOpacity","strokeWidth","strokeLinejoin","strokeDasharray","img","_c","$RefreshReg$"],"sources":["/Users/fan/Documents/GitHub/nunu/src/component/MapScene.jsx"],"sourcesContent":["import { useRef, useState, useEffect } from \"react\";\nimport { motion } from \"framer-motion\";\nimport carImg from \"../assets/images/van1.webp\";\nimport markerImg1 from \"../assets/images/cake/mainImage.webp\"; // 假設這是你的第一個標記圖片\nimport markerImg2 from \"../assets/images/cake/mainImage.webp\"; // 假設這是你的第二個標記圖片\n\nexport default function MapScene({ onTrigger }) {\n  const pathA = useRef(null);\n  const pathB = useRef(null);\n  const [carPos, setCarPos] = useState({ x: 0, y: 0 });\n  const [showCar, setShowCar] = useState(true);\n  const [activePath, setActivePath] = useState(null); // 這行其實可以移除，因為沒有被使用到\n\n  // 將車子定位在 pathA 起點，並放大尺寸\n  useEffect(() => {\n    // 確保 pathA.current 已經存在才進行操作\n    if (pathA.current) {\n      const p = pathA.current.getPointAtLength(0);\n      setCarPos({ x: p.x, y: p.y });\n    }\n  }, []);\n\n  // 控制車子行駛動畫\n  const runPath = (pathRef, onComplete) => {\n    const total = pathRef.current.getTotalLength();\n    let start = null;\n    const duration = 1500; // 動畫持續時間 (毫秒)\n\n    const animate = (timestamp) => {\n      if (!start) start = timestamp;\n      const elapsed = timestamp - start;\n      const progress = Math.min(elapsed / duration, 1);\n      const point = pathRef.current.getPointAtLength(total * progress);\n\n      // 更新車子位置，考慮置中\n      setCarPos({ x: point.x - 32, y: point.y - 32 }); // 減去車子寬高的一半 (w-16 h-16 => 8 * 2 = 32)\n\n      if (progress < 1) {\n        requestAnimationFrame(animate);\n      } else {\n        // 動畫結束後，延遲 1 秒呼叫 onComplete\n        setTimeout(() => {\n          onComplete();\n        }, 1000);\n      }\n    };\n\n    requestAnimationFrame(animate);\n  };\n\n  // 點擊按鈕時觸發行駛\n  const handleClick = (target) => {\n    setShowCar(true);\n    const pathRef = target === 1 ? pathA : pathB;\n\n    // 在這裡呼叫 runPath，並將 onTrigger 傳入其回呼函式\n    runPath(pathRef, () => {\n      // 確保 onTrigger 是一個函式才呼叫\n      if (typeof onTrigger === \"function\") {\n        onTrigger(target); // 這裡只會呼叫一次 onTrigger，且在動畫完成後\n      }\n    });\n  };\n\n  // 用圖片替換數字按鈕的標記點\n  const marker = (ref, targetId, imgSrc) => {\n    // 等待 ref.current 存在\n    const total = ref.current?.getTotalLength() || 0;\n    const p = ref.current?.getPointAtLength(total);\n\n    if (!p) return null; // 如果點位不存在，則不渲染\n\n    return (\n      <img\n        src={imgSrc}\n        alt={`marker-${targetId}`}\n        className=\"absolute w-8 h-8 cursor-pointer\" // 圖片尺寸，可以根據需要調整\n        style={{ left: p.x - 12, top: p.y - 12 }} // 調整位置使圖片中心對準路徑終點\n        onClick={() => handleClick(targetId)}\n      />\n    );\n  };\n\n  return (\n    <div className=\"relative w-full h-[300px] bg-white overflow-hidden\">\n      <svg className=\"absolute w-full h-full\" viewBox=\"0 0 700 300\">\n        {/* pathA: 起點 → 點1（左邊） */}\n        <path\n          ref={pathA}\n          d=\"M0 89H227.5V4H337\"\n          fill=\"none\"\n          stroke=\"#3B3B3B\"\n          strokeOpacity=\"0.63\"\n          strokeWidth=\"8\"\n          strokeLinejoin=\"round\"\n          strokeDasharray=\"5 5\"\n        />\n\n        {/* pathB: 點1 → 點2（右邊，已整體右移） */}\n        <path\n          ref={pathB}\n          d=\"M300 10V209H413V26H491.5\"\n          fill=\"none\"\n          stroke=\"#3B3B3B\"\n          strokeOpacity=\"0.63\"\n          strokeWidth=\"8\"\n          strokeLinejoin=\"round\"\n          strokeDasharray=\"5 5\"\n        />\n      </svg>\n\n      {/* 車子圖片（放大並置中） */}\n      {showCar && (\n        <motion.img\n          src={carImg}\n          alt=\"car\"\n          className=\"absolute w-16 h-16\" // 放大車子（原本可能是 w-8 h-8）\n          style={{ left: carPos.x, top: carPos.y }} // CarPos 現在已經包含了置中計算\n        />\n      )}\n\n      {/* 點擊點位 - 使用圖片 */}\n      {marker(pathA, 1, markerImg1)}\n      {marker(pathB, 2, markerImg2)}\n    </div>\n  );\n}\n"],"mappings":";;AAAA,SAASA,MAAM,EAAEC,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AACnD,SAASC,MAAM,QAAQ,eAAe;AACtC,OAAOC,MAAM,MAAM,4BAA4B;AAC/C,OAAOC,UAAU,MAAM,sCAAsC,CAAC,CAAC;AAC/D,OAAOC,UAAU,MAAM,sCAAsC,CAAC,CAAC;AAAA,SAAAC,MAAA,IAAAC,OAAA;AAE/D,eAAe,SAASC,QAAQA,CAAC;EAAEC;AAAU,CAAC,EAAE;EAAAC,EAAA;EAC9C,MAAMC,KAAK,GAAGZ,MAAM,CAAC,IAAI,CAAC;EAC1B,MAAMa,KAAK,GAAGb,MAAM,CAAC,IAAI,CAAC;EAC1B,MAAM,CAACc,MAAM,EAAEC,SAAS,CAAC,GAAGd,QAAQ,CAAC;IAAEe,CAAC,EAAE,CAAC;IAAEC,CAAC,EAAE;EAAE,CAAC,CAAC;EACpD,MAAM,CAACC,OAAO,EAAEC,UAAU,CAAC,GAAGlB,QAAQ,CAAC,IAAI,CAAC;EAC5C,MAAM,CAACmB,UAAU,EAAEC,aAAa,CAAC,GAAGpB,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC;;EAEpD;EACAC,SAAS,CAAC,MAAM;IACd;IACA,IAAIU,KAAK,CAACU,OAAO,EAAE;MACjB,MAAMC,CAAC,GAAGX,KAAK,CAACU,OAAO,CAACE,gBAAgB,CAAC,CAAC,CAAC;MAC3CT,SAAS,CAAC;QAAEC,CAAC,EAAEO,CAAC,CAACP,CAAC;QAAEC,CAAC,EAAEM,CAAC,CAACN;MAAE,CAAC,CAAC;IAC/B;EACF,CAAC,EAAE,EAAE,CAAC;;EAEN;EACA,MAAMQ,OAAO,GAAGA,CAACC,OAAO,EAAEC,UAAU,KAAK;IACvC,MAAMC,KAAK,GAAGF,OAAO,CAACJ,OAAO,CAACO,cAAc,CAAC,CAAC;IAC9C,IAAIC,KAAK,GAAG,IAAI;IAChB,MAAMC,QAAQ,GAAG,IAAI,CAAC,CAAC;;IAEvB,MAAMC,OAAO,GAAIC,SAAS,IAAK;MAC7B,IAAI,CAACH,KAAK,EAAEA,KAAK,GAAGG,SAAS;MAC7B,MAAMC,OAAO,GAAGD,SAAS,GAAGH,KAAK;MACjC,MAAMK,QAAQ,GAAGC,IAAI,CAACC,GAAG,CAACH,OAAO,GAAGH,QAAQ,EAAE,CAAC,CAAC;MAChD,MAAMO,KAAK,GAAGZ,OAAO,CAACJ,OAAO,CAACE,gBAAgB,CAACI,KAAK,GAAGO,QAAQ,CAAC;;MAEhE;MACApB,SAAS,CAAC;QAAEC,CAAC,EAAEsB,KAAK,CAACtB,CAAC,GAAG,EAAE;QAAEC,CAAC,EAAEqB,KAAK,CAACrB,CAAC,GAAG;MAAG,CAAC,CAAC,CAAC,CAAC;;MAEjD,IAAIkB,QAAQ,GAAG,CAAC,EAAE;QAChBI,qBAAqB,CAACP,OAAO,CAAC;MAChC,CAAC,MAAM;QACL;QACAQ,UAAU,CAAC,MAAM;UACfb,UAAU,CAAC,CAAC;QACd,CAAC,EAAE,IAAI,CAAC;MACV;IACF,CAAC;IAEDY,qBAAqB,CAACP,OAAO,CAAC;EAChC,CAAC;;EAED;EACA,MAAMS,WAAW,GAAIC,MAAM,IAAK;IAC9BvB,UAAU,CAAC,IAAI,CAAC;IAChB,MAAMO,OAAO,GAAGgB,MAAM,KAAK,CAAC,GAAG9B,KAAK,GAAGC,KAAK;;IAE5C;IACAY,OAAO,CAACC,OAAO,EAAE,MAAM;MACrB;MACA,IAAI,OAAOhB,SAAS,KAAK,UAAU,EAAE;QACnCA,SAAS,CAACgC,MAAM,CAAC,CAAC,CAAC;MACrB;IACF,CAAC,CAAC;EACJ,CAAC;;EAED;EACA,MAAMC,MAAM,GAAGA,CAACC,GAAG,EAAEC,QAAQ,EAAEC,MAAM,KAAK;IAAA,IAAAC,YAAA,EAAAC,aAAA;IACxC;IACA,MAAMpB,KAAK,GAAG,EAAAmB,YAAA,GAAAH,GAAG,CAACtB,OAAO,cAAAyB,YAAA,uBAAXA,YAAA,CAAalB,cAAc,CAAC,CAAC,KAAI,CAAC;IAChD,MAAMN,CAAC,IAAAyB,aAAA,GAAGJ,GAAG,CAACtB,OAAO,cAAA0B,aAAA,uBAAXA,aAAA,CAAaxB,gBAAgB,CAACI,KAAK,CAAC;IAE9C,IAAI,CAACL,CAAC,EAAE,OAAO,IAAI,CAAC,CAAC;;IAErB,oBACEf,OAAA;MACEyC,GAAG,EAAEH,MAAO;MACZI,GAAG,EAAE,UAAUL,QAAQ,EAAG;MAC1BM,SAAS,EAAC,iCAAiC,CAAC;MAAA;MAC5CC,KAAK,EAAE;QAAEC,IAAI,EAAE9B,CAAC,CAACP,CAAC,GAAG,EAAE;QAAEsC,GAAG,EAAE/B,CAAC,CAACN,CAAC,GAAG;MAAG,CAAE,CAAC;MAAA;MAC1CsC,OAAO,EAAEA,CAAA,KAAMd,WAAW,CAACI,QAAQ;IAAE;MAAAW,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACtC,CAAC;EAEN,CAAC;EAED,oBACEnD,OAAA;IAAK2C,SAAS,EAAC,oDAAoD;IAAAS,QAAA,gBACjEpD,OAAA;MAAK2C,SAAS,EAAC,wBAAwB;MAACU,OAAO,EAAC,aAAa;MAAAD,QAAA,gBAE3DpD,OAAA;QACEoC,GAAG,EAAEhC,KAAM;QACXkD,CAAC,EAAC,mBAAmB;QACrBC,IAAI,EAAC,MAAM;QACXC,MAAM,EAAC,SAAS;QAChBC,aAAa,EAAC,MAAM;QACpBC,WAAW,EAAC,GAAG;QACfC,cAAc,EAAC,OAAO;QACtBC,eAAe,EAAC;MAAK;QAAAZ,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACtB,CAAC,eAGFnD,OAAA;QACEoC,GAAG,EAAE/B,KAAM;QACXiD,CAAC,EAAC,0BAA0B;QAC5BC,IAAI,EAAC,MAAM;QACXC,MAAM,EAAC,SAAS;QAChBC,aAAa,EAAC,MAAM;QACpBC,WAAW,EAAC,GAAG;QACfC,cAAc,EAAC,OAAO;QACtBC,eAAe,EAAC;MAAK;QAAAZ,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACtB,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACC,CAAC,EAGLzC,OAAO,iBACNV,OAAA,CAACL,MAAM,CAACkE,GAAG;MACTpB,GAAG,EAAE7C,MAAO;MACZ8C,GAAG,EAAC,KAAK;MACTC,SAAS,EAAC,oBAAoB,CAAC;MAAA;MAC/BC,KAAK,EAAE;QAAEC,IAAI,EAAEvC,MAAM,CAACE,CAAC;QAAEsC,GAAG,EAAExC,MAAM,CAACG;MAAE,CAAE,CAAC;IAAA;MAAAuC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAC3C,CACF,EAGAhB,MAAM,CAAC/B,KAAK,EAAE,CAAC,EAAEP,UAAU,CAAC,EAC5BsC,MAAM,CAAC9B,KAAK,EAAE,CAAC,EAAEP,UAAU,CAAC;EAAA;IAAAkD,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAC1B,CAAC;AAEV;AAAChD,EAAA,CAxHuBF,QAAQ;AAAA6D,EAAA,GAAR7D,QAAQ;AAAA,IAAA6D,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}